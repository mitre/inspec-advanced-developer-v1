(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{102:function(s,t,a){s.exports=a.p+"assets/img/InSpec_Pass.226372a3.png"},185:function(s,t,a){s.exports=a.p+"assets/img/InSpec_Orchestration.49064ca9.png"},186:function(s,t,a){s.exports=a.p+"assets/img/Automating_Security_Validation.7b5e7956.png"},187:function(s,t,a){s.exports=a.p+"assets/img/Processing_InSpec_Results.1a05435d.png"},188:function(s,t,a){s.exports=a.p+"assets/img/InSpec_Failure.dd02fb0c.png"},189:function(s,t,a){s.exports=a.p+"assets/img/InSpec_Multiple_Controls.0721ae73.png"},190:function(s,t,a){s.exports=a.p+"assets/img/Tooling_Reporting.689428af.png"},203:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"inspec-advanced-developer-course"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#inspec-advanced-developer-course","aria-hidden":"true"}},[s._v("#")]),s._v(" InSpec Advanced Developer Course")]),s._v(" "),n("h2",{attrs:{id:"_1-about-inspec"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-about-inspec","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. About InSpec")]),s._v(" "),n("ul",[n("li",[s._v("InSpec is an open-source, community-developed  compliance validation framework")]),s._v(" "),n("li",[s._v("Provides a mechanism for defining machine-readable compliance and security requirements")]),s._v(" "),n("li",[s._v("Easy to create, validate, and read content")]),s._v(" "),n("li",[s._v("Cross-platform (Windows, Linux, Mac)")]),s._v(" "),n("li",[s._v("Agnostic to other DevOps tools and techniques")]),s._v(" "),n("li",[s._v("Integrates into multiple CM tools")])]),s._v(" "),n("h3",{attrs:{id:"_1-1-orchestration-configuration-management-validation-to-deployment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-orchestration-configuration-management-validation-to-deployment","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.1. Orchestration, Configuration Management, Validation to Deployment")]),s._v(" "),n("p",[s._v("InSpec operates with most orchestration and CM tools found in the DevOps pipeline implementations\n"),n("img",{attrs:{src:a(185),alt:"Alt text",title:"InSpec Orchestration"}})]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"_1-2-automating-security-validation-using-inspec"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-automating-security-validation-using-inspec","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.2. Automating Security Validation Using InSpec")]),s._v(" "),n("p",[n("img",{attrs:{src:a(186),alt:"Alt text",title:"Automating Security Validation"}})]),s._v(" "),n("hr"),s._v(" "),n("h3",{attrs:{id:"_1-3-processing-inspec-results"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-processing-inspec-results","aria-hidden":"true"}},[s._v("#")]),s._v(" 1.3. Processing InSpec Results")]),s._v(" "),n("p",[n("img",{attrs:{src:a(187),alt:"Alt text",title:"Processing InSpec Results"}})]),s._v(" "),n("h2",{attrs:{id:"_2-course-overview"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-course-overview","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. Course Overview")]),s._v(" "),n("h3",{attrs:{id:"_2-1-inspec-profile-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-inspec-profile-structure","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.1. InSpec Profile Structure")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ tree nginx\n      nginx\n      └── profile\n          ├── README.md\n          ├── attributes.rb\n          ├── controls\n          │   ├── header_size.rb\n          │   └──  ssl_certification.rb\n          ├── inspec.yml\n          └── libraries\n              └── nginx_helper.rb\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("hr"),s._v(" "),n("h3",{attrs:{id:"_2-2-inspec-controls-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-inspec-controls-structure","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.2. InSpec Controls Structure")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("control "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"V-13727"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The worker_processes StartServers directive must be set properly."')]),s._v('\n\n  desc "'),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("These")]),s._v(" requirements are set to mitigate the effects of several types of\n  denial of service attacks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Although")]),s._v(" there is some latitude concerning the\n  settings themselves"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" the requirements attempt to provide reasonable limits\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the protection of the web server"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("If")]),s._v(" necessary"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" these limits can be\n  adjusted to accommodate the operational requirement of a given system"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v('"\n\n  impact '),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.5")]),s._v("\n  tag "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"severity"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"medium"')]),s._v("\n  tag "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gtitle"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"WA000-WWA026"')]),s._v("\n  tag "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"V-13727"')]),s._v("\n  tag "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"rid"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SV-36645r2_rule"')]),s._v("\n  tag "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"stig_id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"WA000-WWA026 A22"')]),s._v("\n  tag "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nist"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CM-6"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Rev_4"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n  tag "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"check"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(' "'),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("To")]),s._v(" view the worker_processes directive value enter the\n  following command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  grep "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("worker_processes"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" on the nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf file "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" any separate included\n  configuration files\n  "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("If")]),s._v(" the value of "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("worker_processes"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" is "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" set to auto "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" explicitly set"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  this is a finding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  worker_processes   auto"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  worker_processes defines the number of worker processes"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("The")]),s._v(" optimal value\n  depends on many factors including "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("but "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("not")]),s._v(" limited to"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" the number of "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CPU")]),s._v("\n  cores"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" the number of hard disk drives that store data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" load pattern"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("When")]),s._v("\n  one is "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" doubt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" setting it to the number of available "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("CPU")]),s._v(" cores would be a\n  good start "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("the value “auto” will try to autodetect it"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v('"\n\n  tag '),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fix"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(' "'),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Edit")]),s._v(" the configuration file "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("and")]),s._v(" set the value of\n  "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v("worker_processes"),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" to the value of auto "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" a value of "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("or")]),s._v(" higher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  worker_processes auto"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v('"\n\n  describe nginx_conf'),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NGINX_CONF_FILE")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("params"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'worker_processes'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'auto'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br")])]),n("h3",{attrs:{id:"_2-3-inspec-results"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-inspec-results","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.3. InSpec Results")]),s._v(" "),n("h4",{attrs:{id:"_2-3-1-failure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-failure","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.3.1. Failure")]),s._v(" "),n("p",[n("img",{attrs:{src:a(188),alt:"Alt text",title:"InSpec Failure"}})]),s._v(" "),n("h4",{attrs:{id:"_2-3-2-pass"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2-pass","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.3.2. Pass")]),s._v(" "),n("p",[n("img",{attrs:{src:a(102),alt:"Alt text",title:"InSpec Pass"}})]),s._v(" "),n("h4",{attrs:{id:"_2-3-3-multiple-controls"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-3-multiple-controls","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.3.3. Multiple Controls")]),s._v(" "),n("p",[n("img",{attrs:{src:a(189),alt:"Alt text",title:"InSpec Multiple Controls"}})]),s._v(" "),n("h3",{attrs:{id:"_2-4-tooling-and-reporting"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-tooling-and-reporting","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.4. Tooling and Reporting")]),s._v(" "),n("p",[n("img",{attrs:{src:a(190),alt:"Alt text",title:"Tooling Reporting"}})]),s._v(" "),n("h3",{attrs:{id:"_2-5-inspec-resources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-inspec-resources","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.5. InSpec Resources")]),s._v(" "),n("p",[s._v("PLACEHOLDER\n"),n("img",{attrs:{src:a(102),alt:"Alt text",title:"InSpec Resource example"}})]),s._v(" "),n("h2",{attrs:{id:"_3-recap-of-an-inspec-profile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-recap-of-an-inspec-profile","aria-hidden":"true"}},[s._v("#")]),s._v(" 3. Recap of an InSpec profile")]),s._v(" "),n("p",[s._v("Let's start by creating a profile that will contain NGINX tests.")]),s._v(" "),n("p",[s._v("Start by moving to the /root directory.")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cd")]),s._v(" ~\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Next, create an InSpec profile named my_nginx.")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("inspec init profile my_nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("The terminal output should look like the following:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ inspec init profile my_nginx\nCreate new profile at /root/my_nginx\n * Create directory controls\n * Create "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" controls/example.rb\n * Create "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" inspec.yml\n * Create directory libraries\n * Create "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" README.md\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"_3-1-understanding-the-profile-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-understanding-the-profile-structure","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.1. Understanding the profile structure")]),s._v(" "),n("p",[s._v("Let's take a look at how the profile is structured. We'll start with how a profile's files are structured and then move to what makes up an InSpec control.")]),s._v(" "),n("p",[s._v("First, run "),n("code",[s._v("tree")]),s._v(" to see what's in the "),n("code",[s._v("my_nginx")]),s._v(" profile.")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ tree my_nginx\n      my_nginx\n      ├── README.md\n      ├── controls\n      │   └── example.rb\n      ├── inspec.yml\n      └── libraries\n\n      2 directories, 3 files\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("Here's the role of each component.")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("README.md")]),s._v(" provides documentation about the profile, including what it covers and how to run it.")]),s._v(" "),n("li",[s._v("The "),n("code",[s._v("controls")]),s._v(" directory contains files which implement the InSpec tests.")]),s._v(" "),n("li",[n("code",[s._v("inspec.yml")]),s._v(" provides metadata, or information, about the profile. Metadata includes the profile's description, author, copyright, and version.")]),s._v(" "),n("li",[s._v("The "),n("code",[s._v("libraries")]),s._v(" directory contains resource extensions. A resource extension enables you to "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/dsl_resource/",target:"_blank",rel:"noopener noreferrer"}},[s._v("define your own resource types"),n("OutboundLink")],1),s._v(". You won't work with resource extensions in this module.")])]),s._v(" "),n("h3",{attrs:{id:"_3-2-understand-a-control-s-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-understand-a-control-s-structure","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.2. Understand a control's structure")]),s._v(" "),n("p",[s._v("Let's take a look at the default control file, "),n("code",[s._v("controls/example.rb")]),s._v(".")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("title "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sample section'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# you can also use plain tests")]),s._v("\ndescribe file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/tmp'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_directory "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# you add controls here")]),s._v("\ncontrol "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tmp-1.0'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# A unique ID for this control")]),s._v("\n  impact "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.7")]),s._v("                                "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The criticality, if this control fails.")]),s._v("\n  title "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Create /tmp directory'")]),s._v("             "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# A human-readable title")]),s._v("\n  desc "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'An optional description...'")]),s._v("\n  describe file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/tmp'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("                  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The actual test")]),s._v("\n    it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_directory "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("Tip for developing profiles")]),s._v(" "),n("p",[s._v("When creating new profiles use the existing example file as a template")])]),s._v(" "),n("p",[s._v("This example shows two tests. Both tests check for the existence of the "),n("code",[s._v("/tmp")]),s._v(" directory. The second test provides additional information about the test. Let's break down each component.")]),s._v(" "),n("ul",[n("li",[n("code",[s._v("control")]),s._v(" (line 12) is followed by the control's name. Each control in a profile has a unique name.")]),s._v(" "),n("li",[n("code",[s._v("impact")]),s._v(" (line 13) measures the relative importance of the test and must be a value between 0.0 and 1.0.")]),s._v(" "),n("li",[n("code",[s._v("title")]),s._v(" (line 14) defines the control's purpose.")]),s._v(" "),n("li",[n("code",[s._v("desc")]),s._v(" (line 15) provides a more complete description of what the control checks for.")]),s._v(" "),n("li",[n("code",[s._v("describe")]),s._v(" (lines 16 — 18) defines the test. Here, the test checks for the existence of the "),n("code",[s._v("/tmp")]),s._v(" directory.")])]),s._v(" "),n("p",[s._v("In Ruby, the "),n("code",[s._v("do")]),s._v(" and "),n("code",[s._v("end")]),s._v(" keywords define a "),n("code",[s._v("block")]),s._v(". An InSpec control always contains at least one "),n("code",[s._v("describe")]),s._v(" block. However, a control can contain many "),n("code",[s._v("describe")]),s._v(" blocks.")]),s._v(" "),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[s._v("More information on a block")]),s._v(" "),n("p",[n("a",{attrs:{href:"http://ruby-for-beginners.rubymonstas.org/blocks.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("block"),n("OutboundLink")],1)])]),s._v(" "),n("h3",{attrs:{id:"_3-3-understand-a-describe-block-s-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-understand-a-describe-block-s-structure","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.3. Understand a describe block's structure")]),s._v(" "),n("p",[s._v("As with many test frameworks, InSpec code resembles natural language. Here's the format of a describe block.")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("describe "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("entity"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("expectation"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("An InSpec test has two main components: the subject to examine and the subject's expected state. Here, "),n("code",[s._v("<entity>")]),s._v(" is the subject you want to examine, for example, a package name, service, file, or network port. The "),n("code",[s._v("<expectation>")]),s._v(" part specifies the desired result or expected state, for example, that a port should be open (or perhaps should not be open.)")]),s._v(" "),n("p",[s._v("Let's take a closer look at the "),n("code",[s._v("describe")]),s._v(" block in the example.")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("describe file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/tmp'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_directory "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v('Because InSpec resembles human-readable language, you might read this test as "/tmp should be a directory." Let\'s break down each component.')]),s._v(" "),n("hr"),s._v(" "),n("h4",{attrs:{id:"_3-3-1-file"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-1-file","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.3.1. file")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/file/",target:"_blank",rel:"noopener noreferrer"}},[s._v("file"),n("OutboundLink")],1),s._v(" is an InSpec "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/",target:"_blank",rel:"noopener noreferrer"}},[s._v("resource"),n("OutboundLink")],1),s._v(". If you're familiar with Chef, you know that a resource configures one part of the system. InSpec resources are similar. For example, the InSpec file resource tests for file attributes, including a file's owner, mode, and permissions. The example examines the /tmp directory.")]),s._v(" "),n("hr"),s._v(" "),n("h4",{attrs:{id:"_3-3-2-it"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-2-it","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.3.2. it")]),s._v(" "),n("p",[s._v("The "),n("code",[s._v("it")]),s._v(" statement validates one of your resource's features. A "),n("code",[s._v("describe")]),s._v(" block contains one or more "),n("code",[s._v("it")]),s._v(" statements. "),n("code",[s._v("it")]),s._v(" enables you to test the resource itself. You'll also see "),n("code",[s._v("its")]),s._v(", which describes some feature of the resource, such as its mode or owner. You'll see examples of both "),n("code",[s._v("it")]),s._v(" and "),n("code",[s._v("its")]),s._v(" shortly.")]),s._v(" "),n("hr"),s._v(" "),n("h4",{attrs:{id:"_3-3-3-should"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-3-should","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.3.3. should")]),s._v(" "),n("p",[n("code",[s._v("should")]),s._v(" describes the expectation. "),n("code",[s._v("should")]),s._v(" asserts that the condition that follows "),n("em",[s._v("should")]),s._v(" be true. Alternatively, "),n("code",[s._v("should_not")]),s._v(" asserts that the condition that follows "),n("em",[s._v("should not")]),s._v(" be true. You'll see examples of both shortly.")]),s._v(" "),n("hr"),s._v(" "),n("h4",{attrs:{id:"_3-3-4-be-directory"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-4-be-directory","aria-hidden":"true"}},[s._v("#")]),s._v(" 3.3.4. be_directory")]),s._v(" "),n("p",[n("code",[s._v("be_directory")]),s._v(" is an example of a "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/matchers/",target:"_blank",rel:"noopener noreferrer"}},[s._v("matcher"),n("OutboundLink")],1),s._v(". A matcher compares a resource's actual value to its expected value. InSpec provides several predefined matchers. The "),n("code",[s._v("file")]),s._v(" resource provides the "),n("code",[s._v("be_directory")]),s._v(" matcher.")]),s._v(" "),n("h2",{attrs:{id:"_4-advanced-techniques-in-profile-development"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-advanced-techniques-in-profile-development","aria-hidden":"true"}},[s._v("#")]),s._v(" 4. Advanced techniques in profile development")]),s._v(" "),n("h3",{attrs:{id:"_4-1-rspec-explicit-subject"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-rspec-explicit-subject","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.1. rspec Explicit Subject")]),s._v(" "),n("p",[s._v("Here we have a inspec test that lists out it's current directory. Our original test code looks like this")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("describe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls -al'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_empty "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("If we would like to have a more "),n("a",{attrs:{href:"https://relishapp.com/rspec/rspec-core/docs/subject/explicit-subject",target:"_blank",rel:"noopener noreferrer"}},[s._v("Explicit Subject"),n("OutboundLink")],1),s._v(" then we could refactor the code like this example")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("describe "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"this is a detailed message"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  subject "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls -al'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  it"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not be_empty "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("h3",{attrs:{id:"_4-2-looping-file-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-looping-file-structure","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.2. looping file structure")]),s._v(" "),n("p",[s._v("For looping through a file directory, the directory resource is not powerful enough to do that, so we are required to use the "),n("code",[s._v("command")]),s._v(" resource and run a "),n("code",[s._v("find")]),s._v(" or it's equivalent for your target OS. This can be very resource intensive on your target so try to be as specific as possible with your search such as the example below:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'find ~/* -type f -maxdepth 0 -xdev'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("each")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("fname"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n  describe file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("fname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'owner'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ec2-user'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_4-3-checking-password-encryption"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-checking-password-encryption","aria-hidden":"true"}},[s._v("#")]),s._v(" 4.3. Checking password encryption")]),s._v(" "),n("p",[s._v("Here we have an inspec test that checks if passwords are SHA512 hashes. As a quick thought exercise can you think of how we can adjust the control below to support SHA512 or higher assuming where you are testing uses SHA1024 or even SHA2048?")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[s._v("bad_users "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("shadow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("where "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"!"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" password "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\$6\\$/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("users\n\ndescribe "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Password hashes in /etc/shadow'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  it "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'should only contain SHA512 hashes'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    failure_message "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Users without SHA512 hashes: '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("bad_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("', '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n    expect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("bad_users"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to be_empty"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" failure_message\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"_5-exploring-inspec-resources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-exploring-inspec-resources","aria-hidden":"true"}},[s._v("#")]),s._v(" 5. Exploring InSpec Resources")]),s._v(" "),n("p",[s._v("Before we dive into the course we want to take a look into what is a resource.")]),s._v(" "),n("p",[s._v("When writing InSpec code, many resources are available to you.")]),s._v(" "),n("ul",[n("li",[s._v("You can "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/",target:"_blank",rel:"noopener noreferrer"}},[s._v("explore the InSpec resources"),n("OutboundLink")],1),s._v(" to see which resources are available.")]),s._v(" "),n("li",[s._v("You can "),n("a",{attrs:{href:"https://github.com/inspec/inspec/tree/master/lib/inspec/resources",target:"_blank",rel:"noopener noreferrer"}},[s._v("examine the source code"),n("OutboundLink")],1),s._v(" to see what's available. For example, you can see how file and other InSpec resources are implemented.")])]),s._v(" "),n("p",[s._v("There's also "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/dsl_resource/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Resource DSL"),n("OutboundLink")],1),s._v(", which gives a brief overview of how to write your own resource.")]),s._v(" "),n("h3",{attrs:{id:"_5-1-resource-overview"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-resource-overview","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.1. Resource Overview")]),s._v(" "),n("p",[s._v("Resources may be added to profiles in the libraries folder:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$ tree examples/profile\nexamples/profile\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n├── libraries\n│   └── gordon_config.rb\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("h3",{attrs:{id:"_5-2-resource-structure"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-resource-structure","aria-hidden":"true"}},[s._v("#")]),s._v(" 5.2. Resource Structure")]),s._v(" "),n("p",[s._v("The smallest possible resource takes this form:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Tiny")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'tiny'")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("Resources are written as a regular Ruby class which inherits from Inspec.resource. The number (1) specifies the version this resource plugin targets. As Chef InSpec evolves, this interface may change and may require a higher version.")]),s._v(" "),n("p",[s._v("The following attributes can be configured:")]),s._v(" "),n("p",[s._v("name - Identifier of the resource (required)\ndesc - Description of the resource (optional)\nexample - Example usage of the resource (optional)\nsupports - (Chef InSpec 2.0+) Platform restrictions of the resource (optional)\nThe following methods are available to the resource:")]),s._v(" "),n("p",[s._v("inspec - Contains a registry of all other resources to interact with the operating system or target in general.\nskip_resource - A resource may call this method to indicate that requirements aren’t met. All tests that use this resource will be marked as skipped.")]),s._v(" "),n("p",[s._v("The following example shows a full resource using attributes and methods to provide simple access to a configuration file:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("GordonConfig")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'gordon_config'")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Restrict to only run on the below platforms (if none were given, all OS's supported)")]),s._v("\n  supports platform_family"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'fedora'")]),s._v("\n  supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'centos'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" release"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'6.9'")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Supports `*` for wildcard matcher in the release")]),s._v("\n  supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'centos'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" release"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'7.*'")]),s._v("\n\n  desc '\n    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Resource")]),s._v(" description "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n  '\n\n  example '\n    describe gordon_config "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n      its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"signal"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should eq "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"on"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  '\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Load the configuration file on initialization")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/etc/gordon.conf'")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("SimpleConfig")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" read_content "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Expose all parameters of the configuration file.")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("method_missing")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_content")])]),s._v("\n    f "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Test if the path exist and that it's a file")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" f"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("file"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Retrieve the file's contents")]),s._v("\n      f"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("content\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If the file doesn't exist, skip all tests that use gordon_config")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Exceptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ResourceSkipped")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"Can't read config at "),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br")])]),n("h2",{attrs:{id:"_6-explore-the-basics-of-a-resource"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-explore-the-basics-of-a-resource","aria-hidden":"true"}},[s._v("#")]),s._v(" 6. Explore the basics of a resource")]),s._v(" "),n("h3",{attrs:{id:"_6-1-class"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-class","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.1. class")]),s._v(" "),n("h3",{attrs:{id:"_6-2-name"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-name","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.2. name")]),s._v(" "),n("h3",{attrs:{id:"_6-3-supports"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-3-supports","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.3. supports")]),s._v(" "),n("h3",{attrs:{id:"_6-4-desc-examples"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-4-desc-examples","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.4. desc & examples")]),s._v(" "),n("h3",{attrs:{id:"_6-5-initialize-method"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-initialize-method","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.5. initialize method")]),s._v(" "),n("h3",{attrs:{id:"_6-6-functionality-methods"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-functionality-methods","aria-hidden":"true"}},[s._v("#")]),s._v(" 6.6. functionality methods")]),s._v(" "),n("h2",{attrs:{id:"_7-local-resource-vs-builtin-resource"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-local-resource-vs-builtin-resource","aria-hidden":"true"}},[s._v("#")]),s._v(" 7. Local Resource vs Builtin Resource")]),s._v(" "),n("h3",{attrs:{id:"_7-1-local-resource"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-local-resource","aria-hidden":"true"}},[s._v("#")]),s._v(" 7.1. Local Resource")]),s._v(" "),n("h3",{attrs:{id:"_7-2-builtin-inspec-resource"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-builtin-inspec-resource","aria-hidden":"true"}},[s._v("#")]),s._v(" 7.2. Builtin InSpec Resource")]),s._v(" "),n("h2",{attrs:{id:"_8-dissecting-resources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-dissecting-resources","aria-hidden":"true"}},[s._v("#")]),s._v(" 8. Dissecting Resources")]),s._v(" "),n("h3",{attrs:{id:"_8-1-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-nginx","aria-hidden":"true"}},[s._v("#")]),s._v(" 8.1. NGINX")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pathname"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hashie/mash"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inspec/resources/command"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Resources")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Nginx")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix"')]),s._v("\n    desc "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Use the nginx InSpec audit resource to test information about your NGINX instance."')]),s._v("\n    example "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n      describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'conf_path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/etc/nginx/nginx.conf'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      describe nginx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/etc/sbin/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'version'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.0.0'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      describe nginx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'modules'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'my_module'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":bin_dir")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginx_path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/sbin/nginx"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The `nginx` resource is not yet available on your OS."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("windows"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The `nginx` binary not found in the path provided."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("nginx_path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("nginx_path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' -V 2>&1"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exit_status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Error using the command nginx -V"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      read_content\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{error_log_path http_client_body_temp_path http_fastcgi_temp_path http_log_path http_proxy_temp_path http_scgi_temp_path http_uwsgi_temp_path lock_path modules_path prefix sbin_path service version}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("each")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("property"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("define_method")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("property"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_sym"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("property"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_sym"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("openssl_version")])]),s._v("\n      result "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/built with OpenSSL\\s(\\S+)\\s(\\d+\\s\\S+\\s\\d{4})/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("compiler_info")])]),s._v("\n      result "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/built by (\\S+)\\s(\\S+)\\s(\\S+)/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"compiler"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"date"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("support_info")])]),s._v("\n      support_info "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/(.*\\S+) support enabled/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten\n      support_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" support_info"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('" "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("modules")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--with-(\\S+)_module/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("to_s")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Nginx Environment"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("read_content")])]),s._v("\n      parse_config\n      parse_path\n      parse_http_path\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_config")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":prefix")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--prefix=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":service")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("%r{nginx version: nginx\\/(\\S+)\\s}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_path")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":sbin_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--sbin-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":modules_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--modules-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":error_log_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--error-log-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":http_log_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--http-log-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":lock_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--lock-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_http_path")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":http_client_body_temp_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--http-client-body-temp-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":http_proxy_temp_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--http-proxy-temp-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":http_fastcgi_temp_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--http-fastcgi-temp-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":http_uwsgi_temp_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--http-uwsgi-temp-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@params")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":http_scgi_temp_path")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@data")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("scan"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/--http-scgi-temp-path=(\\S+)\\s/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("flatten"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("first\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br")])]),n("h3",{attrs:{id:"_8-2-file"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-file","aria-hidden":"true"}},[s._v("#")]),s._v(" 8.2. File")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2015, Vulcano Security GmbH")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shellwords"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inspec/utils/parser"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Resources")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilePermissionsSelector")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("select_file_perms_style")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("unix"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("UnixFilePermissions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("windows"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("WindowsFilePermissions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# TODO: rename file_resource.rb")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FileResource")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    include "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilePermissionsSelector")]),s._v("\n    include "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("LinuxMountParser")]),s._v("\n\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"windows"')]),s._v("\n    desc "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Use the file InSpec audit resource to test all system file types, including files, directories, symbolic links, named pipes, sockets, character devices, block devices, and doors."')]),s._v("\n    example "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n      describe file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should exist "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_file "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_readable "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_writable "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_executable"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("by_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_owned_by "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'mode'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0644'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":file")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":mount_options")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# select permissions style")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" select_file_perms_style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@file")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{\n      type exist? file? block_device? character_device? socket? directory?\n      symlink? pipe? mode mode? owner owned_by? group grouped_into?\n      link_path shallow_link_path linked_to? mtime size selinux_label immutable?\n      product_version file_version version? md5sum sha256sum\n      path basename source source_path uid gid\n    }")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("each")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("m"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("define_method")]),s._v(" m "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("args"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("send"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("m"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("content")])]),s._v("\n      res "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("content\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("force_encoding"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"utf-8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("contain")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("_"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Contain is not supported. Please use standard RSpec matchers."')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("readable")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`readable?` is not supported on your OS yet."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      file_permission_granted"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("writable")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`writable?` is not supported on your OS yet."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      file_permission_granted"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("executable")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`executable?` is not supported on your OS yet."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      file_permission_granted"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"execute"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("allowed")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("permission"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" opts "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`allowed?` is not supported on your OS yet."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      file_permission_granted"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("permission"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":by")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" opts"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":by_user")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("mounted")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("expected_options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" identical "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      mounted "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mounted\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# return if no additional parameters have been provided")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mounted"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" expected_options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# deprecation warning, this functionality will be removed in future version")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("deprecate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":file_resource_be_mounted_matchers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The file resource `be_mounted.with` and `be_mounted.only_with` matchers are deprecated. Please use the `mount` resource instead"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# we cannot read mount data on non-Linux systems")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("linux"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# parse content if we are on linux")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@mount_options")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" parse_mount_options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mounted"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" identical\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# check if the options should be identical")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@mount_options")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" expected_options\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# otherwise compare the selected values")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@mount_options")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("contains"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("expected_options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("suid")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("04000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alias")]),s._v(" setuid"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" suid\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sgid")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("02000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alias")]),s._v(" setgid"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" sgid\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("sticky")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("01000")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alias")]),s._v(" sticky"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" sticky\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("more_permissive_than")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Exceptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ResourceFailed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The file"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("path "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"doesn\'t seem to exist"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ArgumentError")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You must proivde a value for the `maximum allowable permission` for the file."')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" max_mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ArgumentError")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You must proivde the `maximum permission target` as a `String`, you provided: "')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" max_mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_s "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" max_mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_a"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("String")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ArgumentError")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The value of the `maximum permission target` should be a valid file mode in 4-ditgit octal format: for example, `0644` or `0777`"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/(0)?([0-7])([0-7])([0-7])/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("match"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("max_mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Using the files mode and a few bit-wise calculations we can ensure a")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# file is no more permisive than desired.")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. Calculate the inverse of the desired mode (e.g., 0644) by XOR it with")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0777 (all 1s). We are interested in the bits that are currently 0 since")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# it indicates that the actual mode is more permissive than the desired mode.")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Conversely, we dont care about the bits that are currently 1 because they")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cannot be any more permissive and we can safely ignore them.")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. Calculate the above result of ANDing the actual mode and the inverse")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mode. This will determine if any of the bits that would indicate a more")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# permissive mode are set in the actual mode.")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3. If the result is 0000, the files mode is equal")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# to or less permissive than the desired mode (PASS). Otherwise, the files")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mode is more permissive than the desired mode (FAIL).")]),s._v("\n\n      max_mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" max_mode"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_i"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      inv_mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0777")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("^")]),s._v(" max_mode\n\n      inv_mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("to_s")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"File '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("source_path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("file_permission_granted")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`file_permission_granted?` is not supported on your OS"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("check_file_permission_by_mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@perms_provider")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("check_file_permission_by_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" by_specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" source_path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FilePermissions")]),s._v("\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":inspec")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@inspec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("UnixFilePermissions")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilePermissions")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("permission_flag")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" access_type\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"r"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"w"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"execute"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"x"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Invalid access_type provided"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("usergroup_for")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" usergroup "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"others"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"other"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"all"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        usergroup\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("check_file_permission_by_mask")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      usergroup "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" usergroup_for"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      flag "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" permission_flag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      mask "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("unix_mode_mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" flag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Invalid usergroup/owner provided"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("mode "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("check_file_permission_by_user")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      flag "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" permission_flag"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("linux"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        perm_cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"su -s /bin/sh -c \\"test -'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("flag"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('\\" '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("bsd"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("solaris"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        perm_cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sudo -u '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" test -"),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("flag"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aix"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        perm_cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"su '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" -c test -"),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("flag"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hpux"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        perm_cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"su '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' -c \\"test -'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("flag"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" "),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('\\""')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" skip_resource "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The `file` resource does not support `by_user` on your OS."')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("perm_cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exit_status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("WindowsFilePermissions")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilePermissions")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("check_file_permission_by_mask")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("_file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _usergroup"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _specific_user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`check_file_permission_by_mask` is not supported on Windows"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("more_permissive_than")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Exceptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ResourceSkipped")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The `more_permissive_than?` matcher is not supported on your OS yet."')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("check_file_permission_by_user")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" user"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      access_rule "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      access_rule "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" convert_to_powershell_array"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_rule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n      cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"@(@((Get-Acl '"),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v("').access | Where-Object {$_.AccessControlType -eq 'Allow' -and $_.IdentityReference -eq '"),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("user"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v("' }) | Where-Object {($_.FileSystemRights.ToString().Split(',') | % {$_.trim()} | ? {"),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("access_rule"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' -contains $_}) -ne $null}) | measure | % { $_.Count }"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("chomp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("true")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("convert_to_powershell_array")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" arr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@()"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%{@('"),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("arr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"', '\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v("')}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Translates a developer-friendly string into a list of acceptable")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FileSystemRights that match it, because Windows has a fun heirarchy")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# of permissions that are able to be noted in multiple ways.")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# See also: https://www.codeproject.com/Reference/871338/AccessControl-FileSystemRights-Permissions-Table")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("translate_perm_names")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      names "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" translate_common_perms"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      names "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" translate_granular_perms"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      names "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" translate_uncommon_perms"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Invalid access_type provided"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" names\n\n      names\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("translate_common_perms")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" access_type\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"full-control"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{FullControl}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"modify"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"full-control"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{Modify}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"modify"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ReadAndExecute Read}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"modify"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{Write}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"execute"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"modify"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ReadAndExecute ExecuteFile Traverse}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delete"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"modify"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{Delete}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("translate_uncommon_perms")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" access_type\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"delete-subdirectories-and-files"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"full-control"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{DeleteSubdirectoriesAndFiles}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"change-permissions"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"full-control"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ChangePermissions}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"take-ownership"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"full-control"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{TakeOwnership}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"synchronize"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"full-control"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{Synchronize}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("translate_granular_perms")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("access_type"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("case")]),s._v(" access_type\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write-data"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"create-files"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{WriteData CreateFiles}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"append-data"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"create-directories"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{CreateDirectories AppendData}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write-extended-attributes"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{WriteExtendedAttributes}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write-attributes"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"write"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{WriteAttributes}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read-data"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"list-directory"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ReadData ListDirectory}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read-attributes"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ReadAttributes}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read-extended-attributes"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ReadExtendedAttributes}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("when")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read-permissions"')]),s._v("\n        translate_perm_names"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"read"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ReadPermissions}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br"),n("span",{staticClass:"line-number"},[s._v("172")]),n("br"),n("span",{staticClass:"line-number"},[s._v("173")]),n("br"),n("span",{staticClass:"line-number"},[s._v("174")]),n("br"),n("span",{staticClass:"line-number"},[s._v("175")]),n("br"),n("span",{staticClass:"line-number"},[s._v("176")]),n("br"),n("span",{staticClass:"line-number"},[s._v("177")]),n("br"),n("span",{staticClass:"line-number"},[s._v("178")]),n("br"),n("span",{staticClass:"line-number"},[s._v("179")]),n("br"),n("span",{staticClass:"line-number"},[s._v("180")]),n("br"),n("span",{staticClass:"line-number"},[s._v("181")]),n("br"),n("span",{staticClass:"line-number"},[s._v("182")]),n("br"),n("span",{staticClass:"line-number"},[s._v("183")]),n("br"),n("span",{staticClass:"line-number"},[s._v("184")]),n("br"),n("span",{staticClass:"line-number"},[s._v("185")]),n("br"),n("span",{staticClass:"line-number"},[s._v("186")]),n("br"),n("span",{staticClass:"line-number"},[s._v("187")]),n("br"),n("span",{staticClass:"line-number"},[s._v("188")]),n("br"),n("span",{staticClass:"line-number"},[s._v("189")]),n("br"),n("span",{staticClass:"line-number"},[s._v("190")]),n("br"),n("span",{staticClass:"line-number"},[s._v("191")]),n("br"),n("span",{staticClass:"line-number"},[s._v("192")]),n("br"),n("span",{staticClass:"line-number"},[s._v("193")]),n("br"),n("span",{staticClass:"line-number"},[s._v("194")]),n("br"),n("span",{staticClass:"line-number"},[s._v("195")]),n("br"),n("span",{staticClass:"line-number"},[s._v("196")]),n("br"),n("span",{staticClass:"line-number"},[s._v("197")]),n("br"),n("span",{staticClass:"line-number"},[s._v("198")]),n("br"),n("span",{staticClass:"line-number"},[s._v("199")]),n("br"),n("span",{staticClass:"line-number"},[s._v("200")]),n("br"),n("span",{staticClass:"line-number"},[s._v("201")]),n("br"),n("span",{staticClass:"line-number"},[s._v("202")]),n("br"),n("span",{staticClass:"line-number"},[s._v("203")]),n("br"),n("span",{staticClass:"line-number"},[s._v("204")]),n("br"),n("span",{staticClass:"line-number"},[s._v("205")]),n("br"),n("span",{staticClass:"line-number"},[s._v("206")]),n("br"),n("span",{staticClass:"line-number"},[s._v("207")]),n("br"),n("span",{staticClass:"line-number"},[s._v("208")]),n("br"),n("span",{staticClass:"line-number"},[s._v("209")]),n("br"),n("span",{staticClass:"line-number"},[s._v("210")]),n("br"),n("span",{staticClass:"line-number"},[s._v("211")]),n("br"),n("span",{staticClass:"line-number"},[s._v("212")]),n("br"),n("span",{staticClass:"line-number"},[s._v("213")]),n("br"),n("span",{staticClass:"line-number"},[s._v("214")]),n("br"),n("span",{staticClass:"line-number"},[s._v("215")]),n("br"),n("span",{staticClass:"line-number"},[s._v("216")]),n("br"),n("span",{staticClass:"line-number"},[s._v("217")]),n("br"),n("span",{staticClass:"line-number"},[s._v("218")]),n("br"),n("span",{staticClass:"line-number"},[s._v("219")]),n("br"),n("span",{staticClass:"line-number"},[s._v("220")]),n("br"),n("span",{staticClass:"line-number"},[s._v("221")]),n("br"),n("span",{staticClass:"line-number"},[s._v("222")]),n("br"),n("span",{staticClass:"line-number"},[s._v("223")]),n("br"),n("span",{staticClass:"line-number"},[s._v("224")]),n("br"),n("span",{staticClass:"line-number"},[s._v("225")]),n("br"),n("span",{staticClass:"line-number"},[s._v("226")]),n("br"),n("span",{staticClass:"line-number"},[s._v("227")]),n("br"),n("span",{staticClass:"line-number"},[s._v("228")]),n("br"),n("span",{staticClass:"line-number"},[s._v("229")]),n("br"),n("span",{staticClass:"line-number"},[s._v("230")]),n("br"),n("span",{staticClass:"line-number"},[s._v("231")]),n("br"),n("span",{staticClass:"line-number"},[s._v("232")]),n("br"),n("span",{staticClass:"line-number"},[s._v("233")]),n("br"),n("span",{staticClass:"line-number"},[s._v("234")]),n("br"),n("span",{staticClass:"line-number"},[s._v("235")]),n("br"),n("span",{staticClass:"line-number"},[s._v("236")]),n("br"),n("span",{staticClass:"line-number"},[s._v("237")]),n("br"),n("span",{staticClass:"line-number"},[s._v("238")]),n("br"),n("span",{staticClass:"line-number"},[s._v("239")]),n("br"),n("span",{staticClass:"line-number"},[s._v("240")]),n("br"),n("span",{staticClass:"line-number"},[s._v("241")]),n("br"),n("span",{staticClass:"line-number"},[s._v("242")]),n("br"),n("span",{staticClass:"line-number"},[s._v("243")]),n("br"),n("span",{staticClass:"line-number"},[s._v("244")]),n("br"),n("span",{staticClass:"line-number"},[s._v("245")]),n("br"),n("span",{staticClass:"line-number"},[s._v("246")]),n("br"),n("span",{staticClass:"line-number"},[s._v("247")]),n("br"),n("span",{staticClass:"line-number"},[s._v("248")]),n("br"),n("span",{staticClass:"line-number"},[s._v("249")]),n("br"),n("span",{staticClass:"line-number"},[s._v("250")]),n("br"),n("span",{staticClass:"line-number"},[s._v("251")]),n("br"),n("span",{staticClass:"line-number"},[s._v("252")]),n("br"),n("span",{staticClass:"line-number"},[s._v("253")]),n("br"),n("span",{staticClass:"line-number"},[s._v("254")]),n("br"),n("span",{staticClass:"line-number"},[s._v("255")]),n("br"),n("span",{staticClass:"line-number"},[s._v("256")]),n("br"),n("span",{staticClass:"line-number"},[s._v("257")]),n("br"),n("span",{staticClass:"line-number"},[s._v("258")]),n("br"),n("span",{staticClass:"line-number"},[s._v("259")]),n("br"),n("span",{staticClass:"line-number"},[s._v("260")]),n("br"),n("span",{staticClass:"line-number"},[s._v("261")]),n("br"),n("span",{staticClass:"line-number"},[s._v("262")]),n("br"),n("span",{staticClass:"line-number"},[s._v("263")]),n("br"),n("span",{staticClass:"line-number"},[s._v("264")]),n("br"),n("span",{staticClass:"line-number"},[s._v("265")]),n("br"),n("span",{staticClass:"line-number"},[s._v("266")]),n("br"),n("span",{staticClass:"line-number"},[s._v("267")]),n("br"),n("span",{staticClass:"line-number"},[s._v("268")]),n("br"),n("span",{staticClass:"line-number"},[s._v("269")]),n("br"),n("span",{staticClass:"line-number"},[s._v("270")]),n("br"),n("span",{staticClass:"line-number"},[s._v("271")]),n("br"),n("span",{staticClass:"line-number"},[s._v("272")]),n("br"),n("span",{staticClass:"line-number"},[s._v("273")]),n("br"),n("span",{staticClass:"line-number"},[s._v("274")]),n("br"),n("span",{staticClass:"line-number"},[s._v("275")]),n("br"),n("span",{staticClass:"line-number"},[s._v("276")]),n("br"),n("span",{staticClass:"line-number"},[s._v("277")]),n("br"),n("span",{staticClass:"line-number"},[s._v("278")]),n("br"),n("span",{staticClass:"line-number"},[s._v("279")]),n("br"),n("span",{staticClass:"line-number"},[s._v("280")]),n("br"),n("span",{staticClass:"line-number"},[s._v("281")]),n("br"),n("span",{staticClass:"line-number"},[s._v("282")]),n("br"),n("span",{staticClass:"line-number"},[s._v("283")]),n("br"),n("span",{staticClass:"line-number"},[s._v("284")]),n("br"),n("span",{staticClass:"line-number"},[s._v("285")]),n("br"),n("span",{staticClass:"line-number"},[s._v("286")]),n("br"),n("span",{staticClass:"line-number"},[s._v("287")]),n("br"),n("span",{staticClass:"line-number"},[s._v("288")]),n("br"),n("span",{staticClass:"line-number"},[s._v("289")]),n("br"),n("span",{staticClass:"line-number"},[s._v("290")]),n("br"),n("span",{staticClass:"line-number"},[s._v("291")]),n("br"),n("span",{staticClass:"line-number"},[s._v("292")]),n("br"),n("span",{staticClass:"line-number"},[s._v("293")]),n("br"),n("span",{staticClass:"line-number"},[s._v("294")]),n("br"),n("span",{staticClass:"line-number"},[s._v("295")]),n("br"),n("span",{staticClass:"line-number"},[s._v("296")]),n("br"),n("span",{staticClass:"line-number"},[s._v("297")]),n("br"),n("span",{staticClass:"line-number"},[s._v("298")]),n("br"),n("span",{staticClass:"line-number"},[s._v("299")]),n("br"),n("span",{staticClass:"line-number"},[s._v("300")]),n("br"),n("span",{staticClass:"line-number"},[s._v("301")]),n("br"),n("span",{staticClass:"line-number"},[s._v("302")]),n("br"),n("span",{staticClass:"line-number"},[s._v("303")]),n("br"),n("span",{staticClass:"line-number"},[s._v("304")]),n("br"),n("span",{staticClass:"line-number"},[s._v("305")]),n("br"),n("span",{staticClass:"line-number"},[s._v("306")]),n("br"),n("span",{staticClass:"line-number"},[s._v("307")]),n("br"),n("span",{staticClass:"line-number"},[s._v("308")]),n("br"),n("span",{staticClass:"line-number"},[s._v("309")]),n("br"),n("span",{staticClass:"line-number"},[s._v("310")]),n("br"),n("span",{staticClass:"line-number"},[s._v("311")]),n("br"),n("span",{staticClass:"line-number"},[s._v("312")]),n("br"),n("span",{staticClass:"line-number"},[s._v("313")]),n("br"),n("span",{staticClass:"line-number"},[s._v("314")]),n("br"),n("span",{staticClass:"line-number"},[s._v("315")]),n("br"),n("span",{staticClass:"line-number"},[s._v("316")]),n("br"),n("span",{staticClass:"line-number"},[s._v("317")]),n("br"),n("span",{staticClass:"line-number"},[s._v("318")]),n("br"),n("span",{staticClass:"line-number"},[s._v("319")]),n("br"),n("span",{staticClass:"line-number"},[s._v("320")]),n("br"),n("span",{staticClass:"line-number"},[s._v("321")]),n("br"),n("span",{staticClass:"line-number"},[s._v("322")]),n("br"),n("span",{staticClass:"line-number"},[s._v("323")]),n("br"),n("span",{staticClass:"line-number"},[s._v("324")]),n("br"),n("span",{staticClass:"line-number"},[s._v("325")]),n("br"),n("span",{staticClass:"line-number"},[s._v("326")]),n("br"),n("span",{staticClass:"line-number"},[s._v("327")]),n("br"),n("span",{staticClass:"line-number"},[s._v("328")]),n("br"),n("span",{staticClass:"line-number"},[s._v("329")]),n("br"),n("span",{staticClass:"line-number"},[s._v("330")]),n("br"),n("span",{staticClass:"line-number"},[s._v("331")]),n("br"),n("span",{staticClass:"line-number"},[s._v("332")]),n("br"),n("span",{staticClass:"line-number"},[s._v("333")]),n("br"),n("span",{staticClass:"line-number"},[s._v("334")]),n("br"),n("span",{staticClass:"line-number"},[s._v("335")]),n("br")])]),n("h3",{attrs:{id:"_8-3-directory"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-3-directory","aria-hidden":"true"}},[s._v("#")]),s._v(" 8.3. Directory")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inspec/resources/file"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Resources")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Directory")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FileResource")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"directory"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"windows"')]),s._v("\n    desc "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Use the directory InSpec audit resource to test if the file type is a directory. This is equivalent to using the file InSpec audit resource and the be_directory matcher, but provides a simpler and more direct way to test directories. All of the matchers available to file may be used with directory."')]),s._v("\n    example "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n      describe directory"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should be_directory "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exist")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("directory"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("to_s")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Directory '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("source_path"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br")])]),n("h3",{attrs:{id:"_8-4-command"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-4-command","aria-hidden":"true"}},[s._v("#")]),s._v(" 8.4. command")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2015, Vulcano Security GmbH")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inspec/resource"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Resources")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Cmd")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"command"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"windows"')]),s._v("\n    desc "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Use the command InSpec audit resource to test an arbitrary command that is run on the system."')]),s._v("\n    example "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n      describe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls -al /'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stdout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should match "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/bin/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stderr'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should eq "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'exit_status'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should eq "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls -al /'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exist"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" will "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Existence")]),s._v(" of command should be checked this way"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n      describe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ls'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should exist "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":command")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" options "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"InSpec `command` was called with `nil` as the argument. This is not supported. Please provide a valid command instead."')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" cmd\n\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":redact_regex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":redact_regex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_a"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Regexp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Make sure command is replaced so sensitive output isn't shown")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ERROR"')]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("raise")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Exceptions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ResourceFailed")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"The `redact_regex` option must be a regular expression"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@redact_regex")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":redact_regex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("result")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@result")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("run_command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stdout")])]),s._v("\n      result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("stderr")])]),s._v("\n      result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stderr\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exit_status")])]),s._v("\n      result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exit_status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_i\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exist")])]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rubocop:disable Metrics/AbcSize")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# silent for mock resources")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("||")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mock"')]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("linux"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        res "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"alpine"')]),s._v("\n                inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("run_command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"which \\"'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('\\""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n                inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("run_command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bash -c \'type \\"'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('\\"\'"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n              "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("windows"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        res "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("run_command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Get-Command \\"'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('\\""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("elsif")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("unix"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n        res "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("backend"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("run_command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type \\"'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('\\""')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n        warn "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"`command('),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(").exist?` is not supported on your OS: "),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("os"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":name")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      res"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exit_status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_i "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("to_s")])]),s._v("\n      output "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Command: `'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@command")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('`"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Redact output if the `redact_regex` option is passed")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# If no capture groups are passed then `\\1` and `\\2` are ignored")]),s._v("\n      output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gsub"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@redact_regex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\1REDACTED\\2'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@redact_regex")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v("\n      output\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br")])]),n("h3",{attrs:{id:"_8-5-docker"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_8-5-docker","aria-hidden":"true"}},[s._v("#")]),s._v(" 8.5. Docker")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Copyright 2017, Christoph Hartmann")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inspec/resources/command"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inspec/utils/filter"')]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("require")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hashie/mash"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("module")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Resources")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DockerContainerFilter")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use filtertable for containers")]),s._v("\n    filter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilterTable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_custom_matcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":exists?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entries"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":commands")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"command"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":ids")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("            field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":images")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"image"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":labels")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"labels"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" style"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":simple")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":local_volumes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"localvolumes"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":mounts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mounts"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("          field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"names"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":networks")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("       field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"networks"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("          field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ports"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":running_for")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"runningfor"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":sizes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("          field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":status")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"status"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_custom_matcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":running?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("where "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" status"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("downcase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start_with"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"up"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("install_filter_methods_on_resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":containers")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":containers")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("containers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@containers")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" containers\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DockerImageFilter")]),s._v("\n    filter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilterTable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_custom_matcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":exists?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entries"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":ids")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":repositories")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"repository"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":tags")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("          field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tag"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":sizes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("         field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"size"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":digests")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("       field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"digest"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":created")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("       field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdat"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":created_since")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"createdsize"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("install_filter_methods_on_resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":images")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":images")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("images"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@images")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" images\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DockerPluginFilter")]),s._v("\n    filter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilterTable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":ids")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":versions")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("add"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":enabled")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"enabled"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("connect"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":plugins")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":plugins")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("plugins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@plugins")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" plugins\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DockerServiceFilter")]),s._v("\n    filter "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("FilterTable")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("create\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_custom_matcher"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":exists?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("x"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("entries"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":ids")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":names")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":modes")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mode"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":replicas")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"replicas"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":images")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("   field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"image"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("register_column"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":ports")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("    field"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ports"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    filter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("install_filter_methods_on_resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("self")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":services")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    attr_reader "),n("span",{pre:!0,attrs:{class:"token symbol"}},[s._v(":services")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("services"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@services")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" services\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# This resource helps to parse information from the docker host")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# For compatability with Serverspec we also offer the following resouses:")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - docker_container")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# - docker_image")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Docker")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker"')]),s._v("\n    supports platform"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"unix"')]),s._v('\n    desc "\n      '),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("A")]),s._v(' resource to retrieve information about docker\n    "\n\n    example '),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("~")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n      describe docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("containers "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'images'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'u12:latest'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      describe docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("images "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'repositories'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'inssecure_image'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      describe docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("plugins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("where "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'rexray/ebs'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        it "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should exist "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      describe docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("services "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'images'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'inssecure_image'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      describe docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Server.Version'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.12'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Client.Version'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'1.12'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      describe docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n        its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Configuration.Path'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should eq "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("containers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("ids"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("each")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# call docker inspect for a specific container id")]),s._v("\n        describe docker"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("object"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n          its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w(HostConfig Privileged)")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("false")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n          its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w(HostConfig Privileged)")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should_not cmp "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("true")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("EXAMPLE")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("containers")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DockerContainerFilter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parse_containers"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("images")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DockerImageFilter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parse_images"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("plugins")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DockerPluginFilter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parse_plugins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("services")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("DockerServiceFilter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("parse_services"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("version")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@version")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defined")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n      data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"docker version --format '{{ json . }}'\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exit_status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@version")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rescue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ParserError")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" _e\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("info")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@info")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defined")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@info")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n      data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docke info format is only supported for Docker 17.03+")]),s._v("\n      cmd "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"docker info --format '{{ json . }}'\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" cmd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("exit_status "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@info")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rescue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ParserError")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" _e\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# returns information about docker objects")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("object")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@inspect")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("defined")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@inspect")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n      data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker inspect '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("id"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      data "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_a"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("Array")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@inspect")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rescue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ParserError")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" _e\n      "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Hashie")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Mash")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("to_s")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Docker Host"')]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_json_command")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" subcommand"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# build command")]),s._v("\n      format "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("map "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("label"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\"'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("label"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('\\": {{json .'),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("label"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('}}"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n      raw "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("subcommand"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" --format '{"),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("format"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("join"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('", "')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v("}'\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout\n      output "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# since docker is not outputting valid json, we need to parse each row")]),s._v("\n      raw"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("each_line "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("entry"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# convert all keys to lower_case to work well with ruby and filter table")]),s._v("\n        row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("map "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("downcase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" value"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("to_h\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ensure all keys are there")]),s._v("\n        row "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ensure_keys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# strip off any linked container names")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Depending on how it was linked, the actual container name may come before")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or after the link information, so we'll just look for the first name that")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# does not include a slash since that is not a valid character in a container name")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"names"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n          row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"names"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"names"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('","')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("find "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("c"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("c"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("include"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Split labels on ',' or set to empty array")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Allows for `docker.containers.where { labels.include?('app=redis') }`")]),s._v("\n        row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"labels"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("key"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"labels"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"labels"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('","')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n        output"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("push"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("row"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n      output\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rescue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ParserError")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" _e\n      warn "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Could not parse `docker '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("subcommand"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v('` output"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_containers")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# @see https://github.com/moby/moby/issues/20625, works for docker 1.13+")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# raw_containers = inspec.command('docker ps -a --no-trunc --format \\'{{ json . }}\\'').stdout")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# therefore we stick with older approach")]),s._v("\n      labels "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{Command CreatedAt ID Image Labels Mounts Names Ports RunningFor Size Status}")]),s._v("\n\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Networks LocalVolumes work with 1.13+ only")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("empty"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Gem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Client"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Version"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Gem")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Version")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1.13"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("push"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Networks"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("push"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"LocalVolumes"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      parse_json_command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ps -a --no-trunc"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_services")])]),s._v("\n      parse_json_command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("%w{ID Name Mode Replicas Image Ports}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"service ls"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ensure_keys")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      labels"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("each")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("key"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("downcase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("nil")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unless")]),s._v(" entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("key"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("key"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("downcase"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      entry\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_images")])]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker does not support the `json .` function here, therefore we need to emulate that behavior.")]),s._v("\n      raw_images "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'docker images -a --no-trunc --format \\\'{ "id": {{json .ID}}, "repository": {{json .Repository}}, "tag": {{json .Tag}}, "size": {{json .Size}}, "digest": {{json .Digest}}, "createdat": {{json .CreatedAt}}, "createdsize": {{json .CreatedSince}} }\\\'\'')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout\n      c_images "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      raw_images"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("each_line "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("entry"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        c_images"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("push"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      c_images\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rescue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ParserError")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" _e\n      warn "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Could not parse `docker images` output"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("parse_plugins")])]),s._v("\n      plugins "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'docker plugin ls --format \\\'{"id": {{json .ID}}, "name": "{{ with split .Name ":"}}{{index . 0}}{{end}}", "version": "{{ with split .Name ":"}}{{index . 1}}{{end}}", "enabled": {{json .Enabled}} }\\\'\'')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout\n      c_plugins "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      plugins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("each_line "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("entry"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n        c_plugins"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("push"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("parse"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n      c_plugins\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("rescue")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("ParserError")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" _e\n      warn "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Could not parse `docker plugin ls` output"')]),s._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br"),n("span",{staticClass:"line-number"},[s._v("105")]),n("br"),n("span",{staticClass:"line-number"},[s._v("106")]),n("br"),n("span",{staticClass:"line-number"},[s._v("107")]),n("br"),n("span",{staticClass:"line-number"},[s._v("108")]),n("br"),n("span",{staticClass:"line-number"},[s._v("109")]),n("br"),n("span",{staticClass:"line-number"},[s._v("110")]),n("br"),n("span",{staticClass:"line-number"},[s._v("111")]),n("br"),n("span",{staticClass:"line-number"},[s._v("112")]),n("br"),n("span",{staticClass:"line-number"},[s._v("113")]),n("br"),n("span",{staticClass:"line-number"},[s._v("114")]),n("br"),n("span",{staticClass:"line-number"},[s._v("115")]),n("br"),n("span",{staticClass:"line-number"},[s._v("116")]),n("br"),n("span",{staticClass:"line-number"},[s._v("117")]),n("br"),n("span",{staticClass:"line-number"},[s._v("118")]),n("br"),n("span",{staticClass:"line-number"},[s._v("119")]),n("br"),n("span",{staticClass:"line-number"},[s._v("120")]),n("br"),n("span",{staticClass:"line-number"},[s._v("121")]),n("br"),n("span",{staticClass:"line-number"},[s._v("122")]),n("br"),n("span",{staticClass:"line-number"},[s._v("123")]),n("br"),n("span",{staticClass:"line-number"},[s._v("124")]),n("br"),n("span",{staticClass:"line-number"},[s._v("125")]),n("br"),n("span",{staticClass:"line-number"},[s._v("126")]),n("br"),n("span",{staticClass:"line-number"},[s._v("127")]),n("br"),n("span",{staticClass:"line-number"},[s._v("128")]),n("br"),n("span",{staticClass:"line-number"},[s._v("129")]),n("br"),n("span",{staticClass:"line-number"},[s._v("130")]),n("br"),n("span",{staticClass:"line-number"},[s._v("131")]),n("br"),n("span",{staticClass:"line-number"},[s._v("132")]),n("br"),n("span",{staticClass:"line-number"},[s._v("133")]),n("br"),n("span",{staticClass:"line-number"},[s._v("134")]),n("br"),n("span",{staticClass:"line-number"},[s._v("135")]),n("br"),n("span",{staticClass:"line-number"},[s._v("136")]),n("br"),n("span",{staticClass:"line-number"},[s._v("137")]),n("br"),n("span",{staticClass:"line-number"},[s._v("138")]),n("br"),n("span",{staticClass:"line-number"},[s._v("139")]),n("br"),n("span",{staticClass:"line-number"},[s._v("140")]),n("br"),n("span",{staticClass:"line-number"},[s._v("141")]),n("br"),n("span",{staticClass:"line-number"},[s._v("142")]),n("br"),n("span",{staticClass:"line-number"},[s._v("143")]),n("br"),n("span",{staticClass:"line-number"},[s._v("144")]),n("br"),n("span",{staticClass:"line-number"},[s._v("145")]),n("br"),n("span",{staticClass:"line-number"},[s._v("146")]),n("br"),n("span",{staticClass:"line-number"},[s._v("147")]),n("br"),n("span",{staticClass:"line-number"},[s._v("148")]),n("br"),n("span",{staticClass:"line-number"},[s._v("149")]),n("br"),n("span",{staticClass:"line-number"},[s._v("150")]),n("br"),n("span",{staticClass:"line-number"},[s._v("151")]),n("br"),n("span",{staticClass:"line-number"},[s._v("152")]),n("br"),n("span",{staticClass:"line-number"},[s._v("153")]),n("br"),n("span",{staticClass:"line-number"},[s._v("154")]),n("br"),n("span",{staticClass:"line-number"},[s._v("155")]),n("br"),n("span",{staticClass:"line-number"},[s._v("156")]),n("br"),n("span",{staticClass:"line-number"},[s._v("157")]),n("br"),n("span",{staticClass:"line-number"},[s._v("158")]),n("br"),n("span",{staticClass:"line-number"},[s._v("159")]),n("br"),n("span",{staticClass:"line-number"},[s._v("160")]),n("br"),n("span",{staticClass:"line-number"},[s._v("161")]),n("br"),n("span",{staticClass:"line-number"},[s._v("162")]),n("br"),n("span",{staticClass:"line-number"},[s._v("163")]),n("br"),n("span",{staticClass:"line-number"},[s._v("164")]),n("br"),n("span",{staticClass:"line-number"},[s._v("165")]),n("br"),n("span",{staticClass:"line-number"},[s._v("166")]),n("br"),n("span",{staticClass:"line-number"},[s._v("167")]),n("br"),n("span",{staticClass:"line-number"},[s._v("168")]),n("br"),n("span",{staticClass:"line-number"},[s._v("169")]),n("br"),n("span",{staticClass:"line-number"},[s._v("170")]),n("br"),n("span",{staticClass:"line-number"},[s._v("171")]),n("br"),n("span",{staticClass:"line-number"},[s._v("172")]),n("br"),n("span",{staticClass:"line-number"},[s._v("173")]),n("br"),n("span",{staticClass:"line-number"},[s._v("174")]),n("br"),n("span",{staticClass:"line-number"},[s._v("175")]),n("br"),n("span",{staticClass:"line-number"},[s._v("176")]),n("br"),n("span",{staticClass:"line-number"},[s._v("177")]),n("br"),n("span",{staticClass:"line-number"},[s._v("178")]),n("br"),n("span",{staticClass:"line-number"},[s._v("179")]),n("br"),n("span",{staticClass:"line-number"},[s._v("180")]),n("br"),n("span",{staticClass:"line-number"},[s._v("181")]),n("br"),n("span",{staticClass:"line-number"},[s._v("182")]),n("br"),n("span",{staticClass:"line-number"},[s._v("183")]),n("br"),n("span",{staticClass:"line-number"},[s._v("184")]),n("br"),n("span",{staticClass:"line-number"},[s._v("185")]),n("br"),n("span",{staticClass:"line-number"},[s._v("186")]),n("br"),n("span",{staticClass:"line-number"},[s._v("187")]),n("br"),n("span",{staticClass:"line-number"},[s._v("188")]),n("br"),n("span",{staticClass:"line-number"},[s._v("189")]),n("br"),n("span",{staticClass:"line-number"},[s._v("190")]),n("br"),n("span",{staticClass:"line-number"},[s._v("191")]),n("br"),n("span",{staticClass:"line-number"},[s._v("192")]),n("br"),n("span",{staticClass:"line-number"},[s._v("193")]),n("br"),n("span",{staticClass:"line-number"},[s._v("194")]),n("br"),n("span",{staticClass:"line-number"},[s._v("195")]),n("br"),n("span",{staticClass:"line-number"},[s._v("196")]),n("br"),n("span",{staticClass:"line-number"},[s._v("197")]),n("br"),n("span",{staticClass:"line-number"},[s._v("198")]),n("br"),n("span",{staticClass:"line-number"},[s._v("199")]),n("br"),n("span",{staticClass:"line-number"},[s._v("200")]),n("br"),n("span",{staticClass:"line-number"},[s._v("201")]),n("br"),n("span",{staticClass:"line-number"},[s._v("202")]),n("br"),n("span",{staticClass:"line-number"},[s._v("203")]),n("br"),n("span",{staticClass:"line-number"},[s._v("204")]),n("br"),n("span",{staticClass:"line-number"},[s._v("205")]),n("br"),n("span",{staticClass:"line-number"},[s._v("206")]),n("br"),n("span",{staticClass:"line-number"},[s._v("207")]),n("br"),n("span",{staticClass:"line-number"},[s._v("208")]),n("br"),n("span",{staticClass:"line-number"},[s._v("209")]),n("br"),n("span",{staticClass:"line-number"},[s._v("210")]),n("br"),n("span",{staticClass:"line-number"},[s._v("211")]),n("br"),n("span",{staticClass:"line-number"},[s._v("212")]),n("br"),n("span",{staticClass:"line-number"},[s._v("213")]),n("br"),n("span",{staticClass:"line-number"},[s._v("214")]),n("br"),n("span",{staticClass:"line-number"},[s._v("215")]),n("br"),n("span",{staticClass:"line-number"},[s._v("216")]),n("br"),n("span",{staticClass:"line-number"},[s._v("217")]),n("br"),n("span",{staticClass:"line-number"},[s._v("218")]),n("br"),n("span",{staticClass:"line-number"},[s._v("219")]),n("br"),n("span",{staticClass:"line-number"},[s._v("220")]),n("br"),n("span",{staticClass:"line-number"},[s._v("221")]),n("br"),n("span",{staticClass:"line-number"},[s._v("222")]),n("br"),n("span",{staticClass:"line-number"},[s._v("223")]),n("br"),n("span",{staticClass:"line-number"},[s._v("224")]),n("br"),n("span",{staticClass:"line-number"},[s._v("225")]),n("br"),n("span",{staticClass:"line-number"},[s._v("226")]),n("br"),n("span",{staticClass:"line-number"},[s._v("227")]),n("br"),n("span",{staticClass:"line-number"},[s._v("228")]),n("br"),n("span",{staticClass:"line-number"},[s._v("229")]),n("br"),n("span",{staticClass:"line-number"},[s._v("230")]),n("br"),n("span",{staticClass:"line-number"},[s._v("231")]),n("br"),n("span",{staticClass:"line-number"},[s._v("232")]),n("br"),n("span",{staticClass:"line-number"},[s._v("233")]),n("br"),n("span",{staticClass:"line-number"},[s._v("234")]),n("br"),n("span",{staticClass:"line-number"},[s._v("235")]),n("br"),n("span",{staticClass:"line-number"},[s._v("236")]),n("br"),n("span",{staticClass:"line-number"},[s._v("237")]),n("br"),n("span",{staticClass:"line-number"},[s._v("238")]),n("br"),n("span",{staticClass:"line-number"},[s._v("239")]),n("br"),n("span",{staticClass:"line-number"},[s._v("240")]),n("br"),n("span",{staticClass:"line-number"},[s._v("241")]),n("br"),n("span",{staticClass:"line-number"},[s._v("242")]),n("br"),n("span",{staticClass:"line-number"},[s._v("243")]),n("br"),n("span",{staticClass:"line-number"},[s._v("244")]),n("br"),n("span",{staticClass:"line-number"},[s._v("245")]),n("br"),n("span",{staticClass:"line-number"},[s._v("246")]),n("br"),n("span",{staticClass:"line-number"},[s._v("247")]),n("br"),n("span",{staticClass:"line-number"},[s._v("248")]),n("br"),n("span",{staticClass:"line-number"},[s._v("249")]),n("br"),n("span",{staticClass:"line-number"},[s._v("250")]),n("br"),n("span",{staticClass:"line-number"},[s._v("251")]),n("br"),n("span",{staticClass:"line-number"},[s._v("252")]),n("br"),n("span",{staticClass:"line-number"},[s._v("253")]),n("br"),n("span",{staticClass:"line-number"},[s._v("254")]),n("br"),n("span",{staticClass:"line-number"},[s._v("255")]),n("br"),n("span",{staticClass:"line-number"},[s._v("256")]),n("br"),n("span",{staticClass:"line-number"},[s._v("257")]),n("br"),n("span",{staticClass:"line-number"},[s._v("258")]),n("br"),n("span",{staticClass:"line-number"},[s._v("259")]),n("br"),n("span",{staticClass:"line-number"},[s._v("260")]),n("br"),n("span",{staticClass:"line-number"},[s._v("261")]),n("br"),n("span",{staticClass:"line-number"},[s._v("262")]),n("br"),n("span",{staticClass:"line-number"},[s._v("263")]),n("br"),n("span",{staticClass:"line-number"},[s._v("264")]),n("br"),n("span",{staticClass:"line-number"},[s._v("265")]),n("br"),n("span",{staticClass:"line-number"},[s._v("266")]),n("br"),n("span",{staticClass:"line-number"},[s._v("267")]),n("br"),n("span",{staticClass:"line-number"},[s._v("268")]),n("br"),n("span",{staticClass:"line-number"},[s._v("269")]),n("br"),n("span",{staticClass:"line-number"},[s._v("270")]),n("br"),n("span",{staticClass:"line-number"},[s._v("271")]),n("br"),n("span",{staticClass:"line-number"},[s._v("272")]),n("br"),n("span",{staticClass:"line-number"},[s._v("273")]),n("br"),n("span",{staticClass:"line-number"},[s._v("274")]),n("br")])]),n("h2",{attrs:{id:"_9-profile-resource-exercise"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-profile-resource-exercise","aria-hidden":"true"}},[s._v("#")]),s._v(" 9. Profile & Resource exercise")]),s._v(" "),n("h3",{attrs:{id:"_9-1-create-new-profile"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-1-create-new-profile","aria-hidden":"true"}},[s._v("#")]),s._v(" 9.1. Create new profile")]),s._v(" "),n("p",[s._v("Let's start by creating a new profile:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("inspec init profile "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h3",{attrs:{id:"_9-2-develop-controls-to-test-run-controls"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_9-2-develop-controls-to-test-run-controls","aria-hidden":"true"}},[s._v("#")]),s._v(" 9.2. Develop controls to test / run controls")]),s._v(" "),n("p",[s._v("Now lets write some controls and test that they run:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# encoding: utf-8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2018, The Authors")]),s._v("\n\ngit_dir "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/home/chef/apache/.git"')]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The following banches should exist")]),s._v("\ndescribe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("git_dir"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' branch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stdout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should match "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/master/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\ndescribe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("git_dir"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' branch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stdout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should match "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/testBranch/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# What is the current branch")]),s._v("\ndescribe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("git_dir"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' branch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stdout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should match "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/^\\* master/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# What is the latest commit")]),s._v("\ndescribe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("git_dir"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" log -1 --pretty=format:'%h'\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stdout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should match "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/48bf020/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# What is the second to last commit")]),s._v("\ndescribe command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),s._v("git_dir"),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(" log --skip=1 -1 --pretty=format:'%h'\"")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'stdout'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should match "),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/09e9064/")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("h2",{attrs:{id:"_10-develop-resources-to-take-over-above-controls"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-develop-resources-to-take-over-above-controls","aria-hidden":"true"}},[s._v("#")]),s._v(" 10. Develop resources to take over above controls")]),s._v(" "),n("h3",{attrs:{id:"_10-1-rewrite-first-test"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-1-rewrite-first-test","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.1. Rewrite first test")]),s._v(" "),n("p",[s._v("Let's rewrite the first test in our example file as follows:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The following banches should exist")]),s._v("\ndescribe git"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("git_dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'branches'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'master'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("Now let's run the profile")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" -t ssh://\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("We should get an error because the git method and resource are not defined yet")]),s._v(" "),n("h3",{attrs:{id:"_10-2-develop-git-resources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-2-develop-git-resources","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.2. Develop git resources")]),s._v(" "),n("p",[s._v("Let's start by creating a new file called git.rb in the libraries directory, the content of the file should look like this:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# encoding: utf-8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2018, The Authors")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git'")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("Now run the profile again")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" -t ssh://\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("This time we get another error letting us know that we have a resource that has been given the incorrect number of arguments. This means we have given an additional parameter to this resource that we have not yet accepted.")]),s._v(" "),n("p",[s._v("Each resource will require an initialization method.")]),s._v(" "),n("p",[s._v("For our git.rb file lets add that initialization method:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# encoding: utf-8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2018, The Authors")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git'")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("This is saving the path we are passing in from the control into an instance method called path.")]),s._v(" "),n("p",[s._v("Now when we run the profile")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" -t ssh://\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v('The test will run but we will get an error saying we do not have a "branches" method.')]),s._v(" "),n("p",[s._v("So let's go back to our ruby.rb file to fix that as seen below:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# encoding: utf-8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2018, The Authors")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git'")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("branches")])]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("At this point all we have done is just define the branches method lets see how the run changes from here")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" -t ssh://\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("Now the error message says that the branches method is returning a null value when it's expecting an array or something that is able to accept the include method invoked on it")]),s._v(" "),n("p",[s._v("We can use the inspec helper method which enables you to invoke any other inspec resource as seen below:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# encoding: utf-8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2018, The Authors")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git'")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("branches")])]),s._v("\n        inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' branch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br")])]),n("p",[s._v("Now we see that we get a passing test!")]),s._v(" "),n("p",[s._v("Now let's adjust our test to also check for our second branch that we created earlier as well as check our current branch:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# The following banches should exist")]),s._v("\ndescribe git"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("git_dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'branches'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'master'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'branches'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should include "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'testBranch'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  its"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'current_branch'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" should cmp "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'master'")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("Let's head over to the git.rb file to create the current_branch method we are invoking in the above test:")]),s._v(" "),n("div",{staticClass:"language-ruby line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-ruby"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# encoding: utf-8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# copyright: 2018, The Authors")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Git")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[s._v("Inspec")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    name "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'git'")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("initialize")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" path\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("branches")])]),s._v("\n        inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' branch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token method-definition"}},[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("current_branch")])]),s._v("\n        branch_name "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" inspec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("command"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"git --git-dir '),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("#{")]),n("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@path")]),n("span",{pre:!0,attrs:{class:"token delimiter tag"}},[s._v("}")])]),s._v(' branch"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("split"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\n"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("find "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("name"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n            name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start_with"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("?")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n        branch_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gsub"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/^\\*/")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("strip\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("end")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br")])]),n("p",[s._v("Now we can run the profile again")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("inspec "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("exec")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" -t ssh://\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("All the tests should pass!")]),s._v(" "),n("p",[s._v("EXERCISE:"),n("br"),s._v("\nAs solo exercise try to create the final method in the git.rb file to check what is the last commit.")]),s._v(" "),n("h3",{attrs:{id:"_10-3-develop-docker-resources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-3-develop-docker-resources","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.3. Develop docker resources")]),s._v(" "),n("h3",{attrs:{id:"_10-4-rewrite-tests-and-run-controls"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_10-4-rewrite-tests-and-run-controls","aria-hidden":"true"}},[s._v("#")]),s._v(" 10.4. Rewrite tests and run controls")]),s._v(" "),n("h2",{attrs:{id:"_11-resource-development-exercise"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11-resource-development-exercise","aria-hidden":"true"}},[s._v("#")]),s._v(" 11. Resource Development exercise")]),s._v(" "),n("h3",{attrs:{id:"_11-1-what-the-resource-should-do"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_11-1-what-the-resource-should-do","aria-hidden":"true"}},[s._v("#")]),s._v(" 11.1. What the resource should do")]),s._v(" "),n("ul",[n("li",[s._v("a")]),s._v(" "),n("li",[s._v("b")]),s._v(" "),n("li",[s._v("c")]),s._v(" "),n("li",[s._v("d")])]),s._v(" "),n("h2",{attrs:{id:"_12-day-2-exercise-developing-your-own-resources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_12-day-2-exercise-developing-your-own-resources","aria-hidden":"true"}},[s._v("#")]),s._v(" 12. DAY 2: Exercise developing your own resources.")]),s._v(" "),n("ul",[n("li",[s._v("1\n"),n("ul",[n("li",[s._v("a")]),s._v(" "),n("li",[s._v("b")]),s._v(" "),n("li",[s._v("c")])])]),s._v(" "),n("li",[s._v("2\n"),n("ul",[n("li",[s._v("a")]),s._v(" "),n("li",[s._v("b")]),s._v(" "),n("li",[s._v("c")])])]),s._v(" "),n("li",[s._v("3\n"),n("ul",[n("li",[s._v("a")]),s._v(" "),n("li",[s._v("b")]),s._v(" "),n("li",[s._v("c")])])]),s._v(" "),n("li",[s._v("4\n"),n("ul",[n("li",[s._v("a")]),s._v(" "),n("li",[s._v("b")]),s._v(" "),n("li",[s._v("c")])])]),s._v(" "),n("li",[s._v("5\n"),n("ul",[n("li",[s._v("a")]),s._v(" "),n("li",[s._v("b")]),s._v(" "),n("li",[s._v("c")])])])]),s._v(" "),n("h2",{attrs:{id:"_13-day-3-pushing-your-resource-up-to-inspec"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_13-day-3-pushing-your-resource-up-to-inspec","aria-hidden":"true"}},[s._v("#")]),s._v(" 13. DAY 3: Pushing your resource up to inspec")]),s._v(" "),n("p",[s._v("Fork -> Branch -> list directories where changes need to be made.\nGo over writing test cases for resource")]),s._v(" "),n("h2",{attrs:{id:"_14-day-3-update-a-few-resources-that-were-previously-built-and-show-the-process-for-moving-that-resource-to-be-put-in-inspec"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_14-day-3-update-a-few-resources-that-were-previously-built-and-show-the-process-for-moving-that-resource-to-be-put-in-inspec","aria-hidden":"true"}},[s._v("#")]),s._v(" 14. DAY 3: Update a few resources that were previously built and show the process for moving that resource to be put in inspec")]),s._v(" "),n("h2",{attrs:{id:"_15-using-what-you-ve-learned"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_15-using-what-you-ve-learned","aria-hidden":"true"}},[s._v("#")]),s._v(" 15. Using what you've learned")]),s._v(" "),n("p",[s._v("Now you should be able to")]),s._v(" "),n("ul",[n("li",[s._v("Describe the InSpec framework and its capabilities")]),s._v(" "),n("li",[s._v("Describe the architecture of an InSpec profile")]),s._v(" "),n("li",[s._v("Build an InSpec profile to transform security policy into automated security testing")]),s._v(" "),n("li",[s._v("Run an InSpec profile against a component of an application stack")]),s._v(" "),n("li",[s._v("View and analyze InSpec results")]),s._v(" "),n("li",[s._v("Report results")])]),s._v(" "),n("p",[s._v("You can contribute to existing profiles that can be found here:"),n("br"),s._v(" "),n("a",{attrs:{href:"https://github.com/mitre",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/mitre"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("Otherwise you can create your own profiles if they don't exist using the following security guidelines:\n"),n("a",{attrs:{href:"https://iase.disa.mil/stigs/Pages/a-z.aspx",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://iase.disa.mil/stigs/Pages/a-z.aspx"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://www.cisecurity.org/cis-benchmarks/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cisecurity.org/cis-benchmarks/"),n("OutboundLink")],1)]),s._v(" "),n("h2",{attrs:{id:"_16-additional-resources"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-additional-resources","aria-hidden":"true"}},[s._v("#")]),s._v(" 16. Additional Resources")]),s._v(" "),n("h3",{attrs:{id:"_16-1-security-guidance"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-1-security-guidance","aria-hidden":"true"}},[s._v("#")]),s._v(" 16.1 Security Guidance")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://iase.disa.mil/stigs/Pages/a-z.aspx",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://iase.disa.mil/stigs/Pages/a-z.aspx"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://www.cisecurity.org/cis-benchmarks/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://www.cisecurity.org/cis-benchmarks/"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"_16-2-inspec-documentation"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-2-inspec-documentation","aria-hidden":"true"}},[s._v("#")]),s._v(" 16.2 InSpec Documentation")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://www.inspec.io/docs/",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Docs"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/profiles/",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Profiles"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/resources/",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Resources"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/matchers/",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Matchers"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/shell/",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Shell"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://www.inspec.io/docs/reference/reporters/",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Reporters"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://blog.chef.io/2017/07/06/understanding-inspec-profile-inheritance/",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Profile Inheritance"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"_16-3-additional-tutorials"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-3-additional-tutorials","aria-hidden":"true"}},[s._v("#")]),s._v(" 16.3 Additional Tutorials")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://blog.chef.io/2018/04/03/what-to-expect-when-youre-inspecing/",target:"_blank",rel:"noopener noreferrer"}},[s._v("What to Expect When You’re InSpec’ing"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"http://www.anniehedgie.com/inspec/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Getting started with InSpec - The InSpec basics series"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"http://datatomix.com/?p=236",target:"_blank",rel:"noopener noreferrer"}},[s._v("Windows infrastructure testing using InSpec – Part I"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"http://datatomix.com/?p=238",target:"_blank",rel:"noopener noreferrer"}},[s._v("Windows infrastructure testing using InSpec and Profiles – Part II"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"_16-4-mitre-inspec"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-4-mitre-inspec","aria-hidden":"true"}},[s._v("#")]),s._v(" 16.4 MITRE InSpec")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/orgs/mitre/teams/inspec/repositories",target:"_blank",rel:"noopener noreferrer"}},[s._v("MITRE InSpec Repositories"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://github.com/mitre/inspec_tools",target:"_blank",rel:"noopener noreferrer"}},[s._v("InSpec Tools"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://mitre.github.io/heimdall-lite/#",target:"_blank",rel:"noopener noreferrer"}},[s._v("Heimdall Lite"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"_16-5-rspec-documentation"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-5-rspec-documentation","aria-hidden":"true"}},[s._v("#")]),s._v(" 16.5. rspec documentation")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://relishapp.com/rspec/rspec-core/docs/subject/explicit-subject",target:"_blank",rel:"noopener noreferrer"}},[s._v("Explicit Subject"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://github.com/rspec/rspec-expectations/blob/master/Should.md",target:"_blank",rel:"noopener noreferrer"}},[s._v("should and should_not"),n("OutboundLink")],1),n("br"),s._v(" "),n("a",{attrs:{href:"https://relishapp.com/rspec/rspec-expectations/docs/built-in-matchers",target:"_blank",rel:"noopener noreferrer"}},[s._v("Built in matchers"),n("OutboundLink")],1)]),s._v(" "),n("h3",{attrs:{id:"_16-6-slack"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_16-6-slack","aria-hidden":"true"}},[s._v("#")]),s._v(" 16.6. Slack")]),s._v(" "),n("p",[n("a",{attrs:{href:"http://community-slack.chef.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Chef Slack"),n("OutboundLink")],1)])])},[],!1,null,null,null);t.default=e.exports}}]);